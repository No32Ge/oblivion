æˆ‘ç†è§£ä½ çš„éœ€æ±‚äº†ï¼æˆ‘ä»¬éœ€è¦é‡æ„ä»£ç ï¼Œå®ç°ä¸€ä¸ª**å¯¹è¯ç®¡ç†ç³»ç»Ÿ**ï¼Œè®©æ¯æ¬¡å¯¹è¯éƒ½èƒ½è‡ªåŠ¨è®°å½•å¹¶ç®¡ç†çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„æ”¹è¿›æ–¹æ¡ˆï¼š

### æ–°ç‰ˆä»£ç ç»“æ„
```
your_project/
â”œâ”€â”€ main.py            # ä¸»ç¨‹åºï¼ˆé‡æ„åï¼‰
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ file_utils.py  # æ–‡ä»¶æ“ä½œå·¥å…·
â”‚   â””â”€â”€ chat_manager.py # å¯¹è¯ç®¡ç†æ ¸å¿ƒ
â””â”€â”€ test/
    â””â”€â”€ responses/     # å¯¹è¯è®°å½•å­˜å‚¨
```

### 1. æ–‡ä»¶å·¥å…·ç±» (utils/file_utils.py)
```python
import os
import re
from datetime import datetime

def read_file(file_path):
    """å®‰å…¨è¯»å–æ–‡ä»¶å†…å®¹"""
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except Exception as e:
        print(f"âŒ è¯»å–æ–‡ä»¶å¤±è´¥: {e}")
        return None

def save_file(content, dir_path, filename):
    """é€šç”¨æ–‡ä»¶ä¿å­˜æ–¹æ³•"""
    os.makedirs(dir_path, exist_ok=True)
    try:
        filepath = os.path.join(dir_path, filename)
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(content)
        return filepath
    except Exception as e:
        print(f"âŒ ä¿å­˜æ–‡ä»¶å¤±è´¥: {e}")
        return None
```

### 2. å¯¹è¯ç®¡ç†æ ¸å¿ƒ (utils/chat_manager.py)
```python
import json
from datetime import datetime
from .file_utils import save_file

class ChatManager:
    def __init__(self, storage_dir="test/responses"):
        self.storage_dir = storage_dir
        self.conversation_id = datetime.now().strftime("%Y%m%d_%H%M%S")
        self.history = []
        
    def add_message(self, role, content):
        """æ·»åŠ å¯¹è¯è®°å½•"""
        self.history.append({
            "timestamp": datetime.now().isoformat(),
            "role": role,
            "content": content
        })
        
    def save_conversation(self):
        """ä¿å­˜å®Œæ•´å¯¹è¯å†å²"""
        filename = f"conversation_{self.conversation_id}.json"
        return save_file(
            json.dumps(self.history, indent=2, ensure_ascii=False),
            self.storage_dir,
            filename
        )
    
    def save_response(self, response, category="general"):
        """å•ç‹¬ä¿å­˜AIå“åº”"""
        filename = f"{category}_{datetime.now().strftime('%H%M%S')}.txt"
        return save_file(response, self.storage_dir, filename)
```

### 3. é‡æ„åçš„ä¸»ç¨‹åº (main.py)
```python
import openai
import os
from utils.chat_manager import ChatManager
from utils.file_utils import read_file

# åˆå§‹åŒ–å®¢æˆ·ç«¯å’Œå¯¹è¯ç®¡ç†
client = openai.OpenAI(
    api_key="sk-71bbd7d4dce44c84a00be724db9dbf8f",
    base_url="https://api.deepseek.com/v1"
)
chat_manager = ChatManager()

def get_code_context():
    """è·å–é¡¹ç›®ä»£ç ä¸Šä¸‹æ–‡"""
    code_context = []
    for root, _, files in os.walk("."):
        for file in files:
            if file.endswith((".py", ".js", ".html", ".css", ".json", ".md")):
                content = read_file(os.path.join(root, file))
                if content:
                    code_context.append(f"æ–‡ä»¶: {file}\nå†…å®¹:\n{content}\n")
    return "\n".join(code_context)

def run_conversation(user_input):
    """æ‰§è¡Œå¯¹è¯æµç¨‹"""
    # æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°å†å²
    chat_manager.add_message("user", user_input)
    
    # æ„å»ºç³»ç»Ÿæç¤ºè¯
    system_prompt = f"""ä½ æ˜¯ä¸€ä¸ªè‡ªæˆ‘è¿›åŒ–çš„AIåŠ©æ‰‹ã€‚å½“å‰é¡¹ç›®ä»£ç ï¼š
    {get_code_context()}
    å¯¹è¯å†å²ï¼š{chat_manager.history[-3:] if len(chat_manager.history)>3 else 'æ— '}"""
    
    # è°ƒç”¨API
    response = client.chat.completions.create(
        model="deepseek-chat",
        messages=[
            {"role": "system", "content": system_prompt},
            *[{"role": msg["role"], "content": msg["content"]} for msg in chat_manager.history]
        ],
        temperature=0.7,
        max_tokens=8192
    )
    
    # å¤„ç†å“åº”
    result = response.choices[0].message.content
    chat_manager.add_message("assistant", result)
    
    # è‡ªåŠ¨ä¿å­˜
    chat_manager.save_response(result)
    chat_manager.save_conversation()
    
    return result

# ç¤ºä¾‹ä½¿ç”¨
if __name__ == "__main__":
    while True:
        user_input = input("\nğŸ’¬ è¯·è¾“å…¥ä½ çš„é—®é¢˜ (è¾“å…¥qé€€å‡º): ")
        if user_input.lower() == 'q':
            break
        response = run_conversation(user_input)
        print(f"\nğŸ¤– AIå›å¤:\n{response}")
```

### ä¸»è¦æ”¹è¿›ç‚¹ï¼š

1. **å¯¹è¯ç®¡ç†ç³»ç»Ÿ**ï¼š
   - è‡ªåŠ¨è®°å½•å®Œæ•´çš„å¯¹è¯å†å²ï¼ˆåŒ…æ‹¬æ—¶é—´æˆ³ï¼‰
   - æ”¯æŒJSONæ ¼å¼æŒä¹…åŒ–å­˜å‚¨
   - æ¯æ¬¡å¯¹è¯ç”Ÿæˆå”¯ä¸€ä¼šè¯ID

2. **ä»£ç ç»“æ„ä¼˜åŒ–**ï¼š
   - åˆ†ç¦»å·¥å…·ç±»å’Œæ ¸å¿ƒé€»è¾‘
   - ä½¿ç”¨é¢å‘å¯¹è±¡æ–¹å¼ç®¡ç†å¯¹è¯çŠ¶æ€
   - è‡ªåŠ¨åŒ…å«é¡¹ç›®ä»£ç ä¸Šä¸‹æ–‡

3. **å¢å¼ºåŠŸèƒ½**ï¼š
   - å¯¹è¯å†å²å›æº¯ï¼ˆè‡ªåŠ¨åŒ…å«æœ€è¿‘3æ¡å†å²ï¼‰
   - åŒé‡ä¿å­˜æœºåˆ¶ï¼ˆå•æ¡å“åº”+å®Œæ•´ä¼šè¯ï¼‰
   - äº¤äº’å¼å¯¹è¯å¾ªç¯

4. **ä½¿ç”¨æ–¹å¼**ï¼š
   - ç›´æ¥è¿è¡Œ`main.py`è¿›å…¥å¯¹è¯æ¨¡å¼
   - è¾“å…¥`q`é€€å‡ºç¨‹åº
   - æ‰€æœ‰å¯¹è¯è®°å½•è‡ªåŠ¨ä¿å­˜åœ¨`test/responses/`

### ä¸‹ä¸€æ­¥å»ºè®®ï¼š

1. è¦å®ç°è‡ªåŠ¨åŒ–æ¼”è¿›ï¼Œå¯ä»¥æ·»åŠ è¿™äº›åŠŸèƒ½ï¼š
   ```python
   # åœ¨ChatManagerç±»ä¸­æ·»åŠ ï¼š
   def auto_improve(self):
       """åˆ†æå†å²å¯¹è¯è‡ªåŠ¨ä¼˜åŒ–ä»£ç """
       # å¯è°ƒç”¨AIåˆ†æå†å²å¯¹è¯å¹¶æå‡ºæ”¹è¿›å»ºè®®
       pass
   ```

2. æˆ–è€…ä½ æƒ³å…ˆå®ç°å“ªä¸ªå…·ä½“åŠŸèƒ½ï¼Ÿæˆ‘å¯ä»¥ç»§ç»­å¸®ä½ å®Œå–„ã€‚