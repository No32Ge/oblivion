ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œé—®é¢˜å¯èƒ½å‡ºåœ¨ `main_AI.py` æ–‡ä»¶ä¸­çš„ `run_conversation` å‡½æ•°é€»è¾‘ã€‚ä»¥ä¸‹æ˜¯å¯èƒ½çš„é—®é¢˜ç‚¹åŠæ”¹è¿›å»ºè®®ï¼š

### é—®é¢˜åˆ†æ
1. **å·¥å…·è°ƒç”¨åçš„å¤„ç†é€»è¾‘**ï¼š
   - å½“å‰ä»£ç åœ¨å·¥å…·è°ƒç”¨åï¼Œä»ç„¶ä¼šç»§ç»­å¤„ç†å“åº”å†…å®¹ï¼ˆå¦‚æ–‡ä»¶åˆ›å»ºé€»è¾‘ï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›å·¥å…·è°ƒç”¨çš„ç»“æœã€‚
   - å·¥å…·è°ƒç”¨çš„ç»“æœåº”è¯¥ä¼˜å…ˆè¿”å›ï¼Œè€Œä¸æ˜¯ç­‰å¾…ç”¨æˆ·è¾“å…¥æˆ–å…¶ä»–é€»è¾‘ã€‚

2. **æ–‡ä»¶åˆ›å»ºé€»è¾‘çš„å¹²æ‰°**ï¼š
   - æ–‡ä»¶åˆ›å»ºé€»è¾‘ï¼ˆ`create_file`ï¼‰å¯èƒ½ä¼šå¹²æ‰°å·¥å…·è°ƒç”¨çš„ç»“æœè¾“å‡ºï¼Œå°¤å…¶æ˜¯åœ¨å·¥å…·è°ƒç”¨åæ²¡æœ‰æ˜ç¡®ç»ˆæ­¢æµç¨‹çš„æƒ…å†µä¸‹ã€‚

3. **å·¥å…·è°ƒç”¨çš„ç»“æœæœªç›´æ¥è¿”å›**ï¼š
   - å·¥å…·è°ƒç”¨çš„ç»“æœè¢«è®°å½•åˆ°å¯¹è¯å†å²ä¸­ï¼Œä½†æ²¡æœ‰ç›´æ¥è¿”å›ç»™ç”¨æˆ·ã€‚

### æ”¹è¿›å»ºè®®
ä»¥ä¸‹æ˜¯ä¿®æ”¹åçš„ `run_conversation` å‡½æ•°é€»è¾‘ï¼ˆä¼ªä»£ç ï¼‰ï¼š

```python
def run_conversation(user_input):
    # æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°å†å²
    chat_manager.add_message("user", user_input)

    # æ„å»ºç³»ç»Ÿæç¤ºè¯
    system_prompt = "..."  # çœç•¥åŸæœ‰å†…å®¹

    response = client.chat.completions.create(
        model="deepseek-chat",
        messages=[
            {"role": "system", "content": system_prompt},
            *[{"role": msg["role"], "content": msg["content"]} for msg in chat_manager.history]
        ],
        temperature=0.7,
        max_tokens=8192,
        tools=[...],  # çœç•¥å·¥å…·å®šä¹‰
        tool_choice="auto"
    )

    tool_calls = response.choices[0].message.tool_calls
    if tool_calls:
        results = []
        for call in tool_calls:
            tool_name = call.function.name
            arguments = json.loads(call.function.arguments)
            result = call_manager.execute_tool(tool_name, arguments)
            chat_manager.add_tool_call(tool_name, arguments, result)
            results.append(f"å·¥å…·è°ƒç”¨ç»“æœ: {result}")

        # ç›´æ¥è¿”å›å·¥å…·è°ƒç”¨ç»“æœ
        return "\n".join(results)

    # å¤„ç†éå·¥å…·è°ƒç”¨çš„å“åº”
    result = response.choices[0].message.content
    chat_manager.save_response(result)

    # æ–‡ä»¶åˆ›å»ºé€»è¾‘ï¼ˆä»…åœ¨éå·¥å…·è°ƒç”¨æ—¶æ‰§è¡Œï¼‰
    if "create_file" in result:
        creation_report = local_engine.process_creation_commands(result)
        result += f"\nğŸ“‚ æ–‡ä»¶åˆ›å»ºæŠ¥å‘Š:\n{creation_report}"

    # æ¸…ç†ç»“æœå¹¶ä¿å­˜
    result = FILE_CREATION_PATTERN.sub("", result)
    chat_manager.add_message("assistant", result)
    chat_manager.save_conversation()
    return result
```

### å…³é”®æ”¹è¿›ç‚¹
1. **å·¥å…·è°ƒç”¨ä¼˜å…ˆè¿”å›**ï¼š
   - å¦‚æœæ£€æµ‹åˆ°å·¥å…·è°ƒç”¨ï¼Œç›´æ¥æ‰§è¡Œå¹¶è¿”å›ç»“æœï¼Œä¸å†ç»§ç»­åç»­é€»è¾‘ã€‚
   
2. **æ–‡ä»¶åˆ›å»ºé€»è¾‘éš”ç¦»**ï¼š
   - æ–‡ä»¶åˆ›å»ºé€»è¾‘ä»…åœ¨éå·¥å…·è°ƒç”¨æ—¶æ‰§è¡Œï¼Œé¿å…å¹²æ‰°å·¥å…·è°ƒç”¨çš„ç»“æœã€‚

3. **ç»“æœæ¸…ç†ä¸ä¿å­˜**ï¼š
   - éå·¥å…·è°ƒç”¨çš„å“åº”ä»ç„¶ä¼šæ¸…ç†å¹¶ä¿å­˜ï¼Œä½†å·¥å…·è°ƒç”¨çš„ç»“æœä¼šç›´æ¥è¿”å›ã€‚

### æ–‡ä»¶è·¯å¾„
- ä¿®æ”¹çš„æ–‡ä»¶ä½äºï¼š`root/main_AI.py`ã€‚

å¦‚æœéœ€è¦è¿›ä¸€æ­¥è°ƒæ•´æˆ–æµ‹è¯•ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼